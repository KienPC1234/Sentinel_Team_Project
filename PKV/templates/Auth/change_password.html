{% extends "base.html" %}
{% block title %}Đổi mật khẩu{% endblock %}

{% block content %}
<div style="max-width:500px;margin:0 auto;" x-data="{show:false}">
    <div class="animate-fadein" style="margin-bottom:2rem;text-align:center;">
        <i class="bi bi-lock-fill text-red-500" style="font-size:3rem;"></i>
        <h1 style="font-size:1.75rem;font-weight:800;margin-top:0.75rem;">
            <span class="glow-text">Đổi mật khẩu</span>
        </h1>
    </div>

    <div class="glass-card animate-fadein animate-fadein-delay-1" style="padding:2rem;">
        <form method="post" id="changePasswordForm">
            {% csrf_token %}
            <div style="display:grid;gap:1.25rem;">
                <div>
                    <label style="font-size:0.85rem;color:var(--text-muted);display:block;margin-bottom:0.4rem;">Mật
                        khẩu hiện tại</label>
                    <input type="password" name="old_password" class="glass-input" style="width:100%;"
                        placeholder="Nhập mật khẩu hiện tại" required>
                </div>
                <div>
                    <label style="font-size:0.85rem;color:var(--text-muted);display:block;margin-bottom:0.4rem;">Mật
                        khẩu mới</label>
                    <input type="password" name="new_password1" class="glass-input" style="width:100%;"
                        placeholder="Nhập mật khẩu mới (8+ ký tự)" required minlength="8">
                </div>
                <div>
                    <label style="font-size:0.85rem;color:var(--text-muted);display:block;margin-bottom:0.4rem;">Xác
                        nhận mật khẩu mới</label>
                    <input type="password" name="new_password2" class="glass-input" style="width:100%;"
                        placeholder="Nhập lại mật khẩu mới" required minlength="8">
                </div>
            </div>

            <div style="margin-top:1.5rem;display:flex;gap:0.75rem;">
                <a href="/profile/" class="glass-btn" style="padding:0.65rem 1.5rem;">← Quay lại</a>
                <button type="submit" class="glass-btn"
                    style="padding:0.65rem 1.5rem;background:rgba(0,229,255,0.15);border-color:rgba(0,229,255,0.3);flex:1;">
                    <i class="bi bi-key-fill mr-1"></i> Đổi mật khẩu
                </button>
            </div>
        </form>

        {% if error %}
        <div
            style="margin-top:1rem;padding:0.75rem;border-radius:0.5rem;background:rgba(255,23,68,0.1);color:var(--risk-red);font-size:0.85rem;">
            <i class="bi bi-exclamation-triangle-fill mr-1"></i> {{ error }}
        </div>
        {% endif %}
    </div>

    {% if messages %}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            {% for message in messages %}
            if (typeof showToast === 'function') {
                showToast("{{ message|escapejs }}", "{{ message.tags|escapejs }}");
            }
            {% endfor %}
        });
    </script>
    {% endif %}
</div>
{% endblock %}