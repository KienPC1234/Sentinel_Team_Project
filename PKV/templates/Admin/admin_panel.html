{% extends "base.html" %}
{% block title %}Admin Panel{% endblock %}

{% block content %}
<div style="max-width:1200px;margin:0 auto;" x-data="{activeTab:'overview', searchQ:''}">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem;"
        data-aos="fade-down">
        <div>
            <h1 style="font-size:1.75rem;font-weight:800;" data-aos="fade-right" data-aos-delay="100"><span class="glow-text">Admin Panel</span></h1>
            <p style="color:var(--text-muted);font-size:0.9rem;margin-top:0.25rem;" data-aos="fade-right" data-aos-delay="200">Qu·∫£n l√Ω h·ªá th·ªëng ShieldCall VN
            </p>
        </div>
        <div style="display:flex;gap:0.5rem;" data-aos="fade-left" data-aos-delay="300">
            <input type="text" class="glass-input" placeholder="T√¨m ki·∫øm..." x-model="searchQ"
                style="width:250px;padding:0.5rem 0.75rem;font-size:0.85rem;">
        </div>
    </div>

    <!-- System Stats -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;margin-bottom:2rem;"
        data-aos="fade-up" data-aos-delay="400">
        <div class="glass-card" style="padding:1.25rem;">
            <div style="font-size:0.8rem;color:var(--text-muted);">Users</div>
            <div style="font-size:1.75rem;font-weight:800;color:var(--accent-cyan);">2,547</div>
            <div style="font-size:0.75rem;color:var(--risk-green);margin-top:0.25rem;">‚Üë +12% tu·∫ßn n√†y</div>
        </div>
        <div class="glass-card" style="padding:1.25rem;">
            <div style="font-size:0.8rem;color:var(--text-muted);">T·ªïng scans</div>
            <div style="font-size:1.75rem;font-weight:800;">15,247</div>
        </div>
        <div class="glass-card" style="padding:1.25rem;">
            <div style="font-size:0.8rem;color:var(--text-muted);">Reports ch·ªù</div>
            <div style="font-size:1.75rem;font-weight:800;color:var(--risk-yellow);">34</div>
        </div>
        <div class="glass-card" style="padding:1.25rem;">
            <div style="font-size:0.8rem;color:var(--text-muted);">Uptime</div>
            <div style="font-size:1.75rem;font-weight:800;color:var(--risk-green);">99.9%</div>
        </div>
        <div class="glass-card" style="padding:1.25rem;">
            <div style="font-size:0.8rem;color:var(--text-muted);">API calls/h</div>
            <div style="font-size:1.75rem;font-weight:800;color:var(--accent-purple);">1.2K</div>
        </div>
    </div>

    <!-- Quick Navigation: Management Pages -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem;"
        data-aos="fade-up" data-aos-delay="450">
        <a href="{% url 'admin-manage-learn' %}" class="glass-card" style="padding:1.25rem;text-decoration:none;color:inherit;display:flex;align-items:center;gap:1rem;transition:all 0.3s;border:1px solid transparent;" onmouseover="this.style.borderColor='var(--accent-cyan)'" onmouseout="this.style.borderColor='transparent'">
            <div style="width:40px;height:40px;border-radius:10px;background:rgba(6,182,212,0.15);display:flex;align-items:center;justify-content:center;">
                <i class="bi bi-journal-text" style="font-size:1.25rem;color:var(--accent-cyan);"></i>
            </div>
            <div>
                <div style="font-weight:700;font-size:0.9rem;">B√†i h·ªçc</div>
                <div style="font-size:0.75rem;color:var(--text-muted);">LearnHub qu·∫£n l√Ω</div>
            </div>
        </a>
        <a href="{% url 'admin-manage-articles' %}" class="glass-card" style="padding:1.25rem;text-decoration:none;color:inherit;display:flex;align-items:center;gap:1rem;transition:all 0.3s;border:1px solid transparent;" onmouseover="this.style.borderColor='var(--accent-purple)'" onmouseout="this.style.borderColor='transparent'">
            <div style="width:40px;height:40px;border-radius:10px;background:rgba(168,85,247,0.15);display:flex;align-items:center;justify-content:center;">
                <i class="bi bi-newspaper" style="font-size:1.25rem;color:var(--accent-purple);"></i>
            </div>
            <div>
                <div style="font-weight:700;font-size:0.9rem;">Tin t·ª©c</div>
                <div style="font-size:0.75rem;color:var(--text-muted);">B√†i vi·∫øt & ScamRadar</div>
            </div>
        </a>
        <a href="{% url 'admin-manage-forum' %}" class="glass-card" style="padding:1.25rem;text-decoration:none;color:inherit;display:flex;align-items:center;gap:1rem;transition:all 0.3s;border:1px solid transparent;" onmouseover="this.style.borderColor='#f59e0b'" onmouseout="this.style.borderColor='transparent'">
            <div style="width:40px;height:40px;border-radius:10px;background:rgba(245,158,11,0.15);display:flex;align-items:center;justify-content:center;">
                <i class="bi bi-chat-square-dots" style="font-size:1.25rem;color:#f59e0b;"></i>
            </div>
            <div>
                <div style="font-weight:700;font-size:0.9rem;">Di·ªÖn ƒë√†n</div>
                <div style="font-size:0.75rem;color:var(--text-muted);">Forum & B√°o c√°o</div>
            </div>
        </a>
        <a href="{% url 'admin-manage-scenarios' %}" class="glass-card" style="padding:1.25rem;text-decoration:none;color:inherit;display:flex;align-items:center;gap:1rem;transition:all 0.3s;border:1px solid transparent;" onmouseover="this.style.borderColor='var(--risk-green)'" onmouseout="this.style.borderColor='transparent'">
            <div style="width:40px;height:40px;border-radius:10px;background:rgba(34,197,94,0.15);display:flex;align-items:center;justify-content:center;">
                <i class="bi bi-shield-check" style="font-size:1.25rem;color:var(--risk-green);"></i>
            </div>
            <div>
                <div style="font-weight:700;font-size:0.9rem;">K·ªãch b·∫£n</div>
                <div style="font-size:0.75rem;color:var(--text-muted);">Scenarios luy·ªán t·∫≠p</div>
            </div>
        </a>
    </div>

    <!-- Tabs -->
    <div style="display:flex;gap:0.5rem;margin-bottom:1.5rem;flex-wrap:wrap;"
        data-aos="fade-up" data-aos-delay="500">
        <button class="tab-btn" :class="activeTab==='overview'&&'active'" @click="activeTab='overview'"><i
                class="bi bi-bar-chart-fill mr-1"></i> T·ªïng
            quan</button>
        <button class="tab-btn" :class="activeTab==='reports'&&'active'" @click="activeTab='reports'"><i
                class="bi bi-clipboard-check-fill mr-1"></i>
            Reports</button>
        <button class="tab-btn" :class="activeTab==='numbers'&&'active'" @click="activeTab='numbers'"><i
                class="bi bi-phone-fill mr-1"></i> S·ªë ƒêT</button>
        <button class="tab-btn" :class="activeTab==='domains'&&'active'" @click="activeTab='domains'"><i
                class="bi bi-globe2 mr-1"></i>
            Domains</button>
        <button class="tab-btn" :class="activeTab==='system'&&'active'" @click="activeTab='system'"><i
                class="bi bi-gear-fill mr-1"></i> System</button>
        <button class="tab-btn" :class="activeTab==='forum'&&'active'" @click="activeTab='forum'"><i
                class="bi bi-chat-square-dots-fill mr-1"></i> Forum</button>
    </div>

    <!-- Overview -->
    <div x-show="activeTab==='overview'" x-transition>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;">
            <div class="glass-card" style="padding:1.5rem;grid-column:span 2;">
                <h3 style="font-weight:700;margin-bottom:1rem;"><i class="bi bi-graph-up mr-2 text-cyan-400"></i> System
                    Activity (24h)</h3>
                <canvas id="adminChart" height="200"></canvas>
            </div>
            <div class="glass-card" style="padding:1.5rem;">
                <h3 style="font-weight:700;margin-bottom:1rem;"><i
                        class="bi bi-lightning-fill mr-2 text-yellow-500"></i> Recent Activity</h3>
                <div style="display:grid;gap:0.5rem;font-size:0.85rem;">
                    <div
                        style="padding:0.5rem;border-radius:0.5rem;background:var(--glass-border);display:flex;gap:0.5rem;">
                        <span style="color:var(--risk-green);">‚óè</span> User registered: user@mail.com
                    </div>
                    <div
                        style="padding:0.5rem;border-radius:0.5rem;background:var(--glass-border);display:flex;gap:0.5rem;">
                        <span style="color:var(--risk-red);">‚óè</span> Phone 0379****56 flagged RED
                    </div>
                    <div
                        style="padding:0.5rem;border-radius:0.5rem;background:var(--glass-border);display:flex;gap:0.5rem;">
                        <span style="color:var(--risk-yellow);">‚óè</span> New report: phishing domain
                    </div>
                    <div
                        style="padding:0.5rem;border-radius:0.5rem;background:var(--glass-border);display:flex;gap:0.5rem;">
                        <span style="color:var(--accent-cyan);">‚óè</span> AI model health check: OK
                    </div>
                </div>
            </div>
            <div class="glass-card" style="padding:1.5rem;">
                <h3 style="font-weight:700;margin-bottom:1rem;"><i class="bi bi-heart-pulse-fill mr-2 text-red-500"></i>
                    System Health</h3>
                <div style="display:grid;gap:0.75rem;">
                    <div>
                        <div
                            style="display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem;">
                            <span>Database</span><span style="color:var(--risk-green);">OK</span>
                        </div>
                        <div class="risk-meter">
                            <div class="risk-meter-fill" style="width:35%;background:var(--risk-green);"></div>
                        </div>
                    </div>
                    <div>
                        <div
                            style="display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem;">
                            <span>Redis Cache</span><span style="color:var(--risk-green);">OK</span>
                        </div>
                        <div class="risk-meter">
                            <div class="risk-meter-fill" style="width:42%;background:var(--risk-green);"></div>
                        </div>
                    </div>
                    <div>
                        <div
                            style="display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem;">
                            <span>Celery Workers</span><span style="color:var(--risk-green);">3/3</span>
                        </div>
                        <div class="risk-meter">
                            <div class="risk-meter-fill" style="width:100%;background:var(--risk-green);"></div>
                        </div>
                    </div>
                    <div>
                        <div
                            style="display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:0.25rem;">
                            <span>Ollama AI</span><span style="color:var(--risk-green);">Connected</span>
                        </div>
                        <div class="risk-meter">
                            <div class="risk-meter-fill" style="width:20%;background:var(--risk-green);"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reports Management -->
    <div x-show="activeTab==='reports'" x-transition>
        <div class="glass-card" style="padding:1.5rem;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                <h3 style="font-weight:700;"><i class="bi bi-clipboard-check-fill mr-2 text-purple-400"></i> Pending
                    Reports (34)</h3>
                <div style="display:flex;gap:0.5rem;">
                    <button class="tab-btn active" style="font-size:0.75rem;">Pending</button>
                    <button class="tab-btn" style="font-size:0.75rem;">Verified</button>
                    <button class="tab-btn" style="font-size:0.75rem;">Rejected</button>
                </div>
            </div>
            <div style="overflow-x:auto;">
                <table style="width:100%;border-collapse:collapse;font-size:0.85rem;">
                    <thead>
                        <tr style="border-bottom:1px solid var(--glass-border);">
                            <th style="text-align:left;padding:0.75rem;color:var(--text-muted);">ID</th>
                            <th style="text-align:left;padding:0.75rem;color:var(--text-muted);">Type</th>
                            <th style="text-align:left;padding:0.75rem;color:var(--text-muted);">Target</th>
                            <th style="text-align:left;padding:0.75rem;color:var(--text-muted);">Scam</th>
                            <th style="text-align:left;padding:0.75rem;color:var(--text-muted);">Time</th>
                            <th style="text-align:center;padding:0.75rem;color:var(--text-muted);">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom:1px solid var(--glass-border);">
                            <td style="padding:0.75rem;">#1247</td>
                            <td>Phone</td>
                            <td style="font-weight:500;">0379456789</td>
                            <td>Gi·∫£ danh CA</td>
                            <td style="color:var(--text-muted);">5m ago</td>
                            <td style="text-align:center;">
                                <button
                                    style="background:rgba(0,230,118,0.15);color:var(--risk-green);border:none;padding:0.25rem 0.75rem;border-radius:0.25rem;cursor:pointer;margin-right:0.25rem;font-size:0.8rem;"
                                    @click="showToast('Approved!','success')"><i
                                        class="bi bi-check-circle-fill"></i></button>
                                <button
                                    style="background:rgba(255,23,68,0.15);color:var(--risk-red);border:none;padding:0.25rem 0.75rem;border-radius:0.25rem;cursor:pointer;font-size:0.8rem;"
                                    @click="showToast('Rejected','error')"><i class="bi bi-x-circle-fill"></i></button>
                            </td>
                        </tr>
                        <tr style="border-bottom:1px solid var(--glass-border);">
                            <td style="padding:0.75rem;">#1246</td>
                            <td>üåê Domain</td>
                            <td style="font-weight:500;">vietc0mbank.net</td>
                            <td>Phishing</td>
                            <td style="color:var(--text-muted);">15m ago</td>
                            <td style="text-align:center;">
                                <button
                                    style="background:rgba(0,230,118,0.15);color:var(--risk-green);border:none;padding:0.25rem 0.75rem;border-radius:0.25rem;cursor:pointer;margin-right:0.25rem;font-size:0.8rem;"
                                    @click="showToast('Approved!','success')"><i
                                        class="bi bi-check-circle-fill"></i></button>
                                <button
                                    style="background:rgba(255,23,68,0.15);color:var(--risk-red);border:none;padding:0.25rem 0.75rem;border-radius:0.25rem;cursor:pointer;font-size:0.8rem;"
                                    @click="showToast('Rejected','error')"><i class="bi bi-x-circle-fill"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Numbers -->
    <div x-show="activeTab==='numbers'" x-transition>
        <div class="glass-card" style="padding:1.5rem;">
            <h3 style="font-weight:700;margin-bottom:1rem;">Phone Numbers Database</h3>
            <p style="color:var(--text-muted);font-size:0.9rem;">Qu·∫£n l√Ω database s·ªë ƒëi·ªán tho·∫°i v√† m·ª©c r·ªßi ro. S·ª≠
                d·ª•ng Django Admin t·∫°i <a href="/admin/" style="color:var(--accent-cyan);">/admin/</a> ƒë·ªÉ qu·∫£n l√Ω chi
                ti·∫øt.</p>
        </div>
    </div>

    <!-- Domains -->
    <div x-show="activeTab==='domains'" x-transition>
        <div class="glass-card" style="padding:1.5rem;">
            <h3 style="font-weight:700;margin-bottom:1rem;">üåê Domains Database</h3>
            <p style="color:var(--text-muted);font-size:0.9rem;">Qu·∫£n l√Ω danh s√°ch domain phishing/l·ª´a ƒë·∫£o. S·ª≠ d·ª•ng
                Django Admin t·∫°i <a href="/admin/" style="color:var(--accent-cyan);">/admin/</a>.</p>
        </div>
    </div>

    <!-- System -->
    <div x-show="activeTab==='system'" x-transition>
        <div class="glass-card" style="padding:1.5rem;">
            <h3 style="font-weight:700;margin-bottom:1rem;">‚öôÔ∏è System Config</h3>
            <div style="display:grid;gap:0.75rem;">
                <div
                    style="display:flex;justify-content:space-between;padding:0.75rem;border-radius:0.5rem;background:var(--glass-border);font-size:0.9rem;">
                    <span>Django Version</span><span style="font-weight:600;">5.1.8</span>
                </div>
                <div
                    style="display:flex;justify-content:space-between;padding:0.75rem;border-radius:0.5rem;background:var(--glass-border);font-size:0.9rem;">
                    <span>Database</span><span style="font-weight:600;">MySQL</span>
                </div>
                <div
                    style="display:flex;justify-content:space-between;padding:0.75rem;border-radius:0.5rem;background:var(--glass-border);font-size:0.9rem;">
                    <span>Cache</span><span style="font-weight:600;">Redis</span>
                </div>
                <div
                    style="display:flex;justify-content:space-between;padding:0.75rem;border-radius:0.5rem;background:var(--glass-border);font-size:0.9rem;">
                    <span>AI Engine</span><span style="font-weight:600;">Ollama</span>
                </div>
                <div
                    style="display:flex;justify-content:space-between;padding:0.75rem;border-radius:0.5rem;background:var(--glass-border);font-size:0.9rem;">
                    <span>Task Queue</span><span style="font-weight:600;">Celery + Redis</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Forum Management -->
    <div x-show="activeTab==='forum'" x-transition>
        <div style="display:grid;gap:1.5rem;">
            <!-- Forum Stats -->
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;">
                <div class="glass-card" style="padding:1.25rem;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:800;color:#f59e0b;">{{ forum_stats.total_posts|default:"‚Äî" }}</div>
                    <div style="font-size:0.75rem;color:var(--text-muted);">B√†i vi·∫øt</div>
                </div>
                <div class="glass-card" style="padding:1.25rem;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:800;color:var(--accent-cyan);">{{ forum_stats.total_comments|default:"‚Äî" }}</div>
                    <div style="font-size:0.75rem;color:var(--text-muted);">B√¨nh lu·∫≠n</div>
                </div>
                <div class="glass-card" style="padding:1.25rem;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:800;color:var(--risk-red);">{{ forum_stats.total_reports|default:"‚Äî" }}</div>
                    <div style="font-size:0.75rem;color:var(--text-muted);">B√°o c√°o</div>
                </div>
                <div class="glass-card" style="padding:1.25rem;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:800;color:var(--risk-green);">{{ forum_stats.active_today|default:"‚Äî" }}</div>
                    <div style="font-size:0.75rem;color:var(--text-muted);">H√¥m nay</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="glass-card" style="padding:1.5rem;">
                <h3 style="font-weight:700;margin-bottom:1rem;"><i class="bi bi-lightning-fill mr-2 text-yellow-500"></i> Qu·∫£n l√Ω nhanh</h3>
                <div style="display:flex;gap:0.75rem;flex-wrap:wrap;">
                    <a href="{% url 'admin-manage-forum' %}" style="text-decoration:none;background:rgba(245,158,11,0.15);color:#f59e0b;border:1px solid rgba(245,158,11,0.2);padding:0.6rem 1.25rem;border-radius:1rem;font-size:0.85rem;font-weight:700;display:flex;align-items:center;gap:0.5rem;transition:all 0.3s;" onmouseover="this.style.background='rgba(245,158,11,0.25)'" onmouseout="this.style.background='rgba(245,158,11,0.15)'">
                        <i class="bi bi-chat-square-dots"></i> Qu·∫£n l√Ω b√†i vi·∫øt
                    </a>
                    <a href="/forum/" target="_blank" style="text-decoration:none;background:rgba(24,255,255,0.1);color:var(--accent-cyan);border:1px solid rgba(24,255,255,0.15);padding:0.6rem 1.25rem;border-radius:1rem;font-size:0.85rem;font-weight:700;display:flex;align-items:center;gap:0.5rem;transition:all 0.3s;" onmouseover="this.style.background='rgba(24,255,255,0.2)'" onmouseout="this.style.background='rgba(24,255,255,0.1)'">
                        <i class="bi bi-box-arrow-up-right"></i> Xem di·ªÖn ƒë√†n
                    </a>
                    <a href="/admin/core/forumpostreport/" target="_blank" style="text-decoration:none;background:rgba(255,23,68,0.1);color:var(--risk-red);border:1px solid rgba(255,23,68,0.15);padding:0.6rem 1.25rem;border-radius:1rem;font-size:0.85rem;font-weight:700;display:flex;align-items:center;gap:0.5rem;transition:all 0.3s;" onmouseover="this.style.background='rgba(255,23,68,0.2)'" onmouseout="this.style.background='rgba(255,23,68,0.1)'">
                        <i class="bi bi-flag-fill"></i> B√°o c√°o b√†i vi·∫øt
                    </a>
                    <a href="/admin/core/forumcommentreport/" target="_blank" style="text-decoration:none;background:rgba(179,136,255,0.1);color:var(--accent-purple);border:1px solid rgba(179,136,255,0.15);padding:0.6rem 1.25rem;border-radius:1rem;font-size:0.85rem;font-weight:700;display:flex;align-items:center;gap:0.5rem;transition:all 0.3s;" onmouseover="this.style.background='rgba(179,136,255,0.2)'" onmouseout="this.style.background='rgba(179,136,255,0.1)'">
                        <i class="bi bi-flag"></i> B√°o c√°o b√¨nh lu·∫≠n
                    </a>
                </div>
            </div>

            <!-- Recent Posts Preview -->
            <div class="glass-card" style="padding:1.5rem;">
                <h3 style="font-weight:700;margin-bottom:1rem;"><i class="bi bi-clock-history mr-2 text-cyan-400"></i> B√†i vi·∫øt g·∫ßn ƒë√¢y</h3>
                <p style="color:var(--text-muted);font-size:0.85rem;">Truy c·∫≠p <a href="{% url 'admin-manage-forum' %}" style="color:var(--accent-cyan);font-weight:700;">Qu·∫£n l√Ω di·ªÖn ƒë√†n</a> ƒë·ªÉ xem, ch·ªânh s·ª≠a ho·∫∑c x√≥a b√†i vi·∫øt. S·ª≠ d·ª•ng <a href="/admin/core/forumpost/" target="_blank" style="color:var(--accent-cyan);font-weight:700;">Django Admin</a> ƒë·ªÉ qu·∫£n l√Ω n√¢ng cao.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ctx = document.getElementById('adminChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                    datasets: [{
                        label: 'API Calls',
                        data: [120, 80, 200, 450, 380, 500, 320],
                        borderColor: '#00e5ff',
                        backgroundColor: 'rgba(0,229,255,0.1)',
                        fill: true, tension: 0.4
                    }, {
                        label: 'Scans',
                        data: [50, 30, 100, 250, 200, 280, 180],
                        borderColor: '#b388ff',
                        backgroundColor: 'rgba(179,136,255,0.1)',
                        fill: true, tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { labels: { color: 'rgba(255,255,255,0.7)' } } },
                    scales: {
                        x: { ticks: { color: 'rgba(255,255,255,0.5)' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                        y: { ticks: { color: 'rgba(255,255,255,0.5)' }, grid: { color: 'rgba(255,255,255,0.05)' } }
                    }
                }
            });
        }
    });
</script>
{% endblock %}